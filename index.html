<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Lägg till denna länk i din head-tagg -->
    <link href="https://fonts.googleapis.com/css2?family=Exo+2&display=swap" rel="stylesheet">


    <style>
        .nav {
            color: rgb(0, 0, 0);
            z-index: 9999;
            /* Sätt ett högt värde här */
        }

        .nav__trigger-finger {
            position: fixed;
            top: 0;
            right: 0;
            z-index: 3100;
            display: flex;
            align-items: center;
            width: 15px;
            height: 10px;
            margin: 40px;
            color: rgb(255, 247, 179);
        }

        .nav__trigger-finger::before {
            content: "";
            position: absolute;
            top: -5px;
            left: -5px;
            bottom: -5px;
            right: -5px;
            background: rgb(0, 0, 0);
            opacity: 0;
            z-index: 3101;
            transition: opacity 0.3s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__trigger-finger span {
            display: block;
            width: 100%;
            height: 2px;
            transition: transform 1s cubic-bezier(0.75, 0, 0.25, 1);
            background: currentColor;
        }

        .nav__trigger-finger span::before,
        .nav__trigger-finger span::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            display: block;
            height: 2px;
            background: currentColor;
            transition: transform 0.4s cubic-bezier(0.75, 0, 0.25, 1), top 0.4s 0.4s cubic-bezier(0.75, 0, 0.25, 1), background 0.2s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__trigger-finger span::before {
            top: 0;
        }

        .nav__trigger-finger span::after {
            top: calc(100% - 2px);
        }

        .nav__trigger-input,
        .nav__submenu-trigger-input {
            opacity: 0;
            width: 0;
            height: 0;
            appearance: none;
            position: fixed;
        }

        .nav__trigger-input:focus+label {
            color: rgb(0, 0, 0);
        }

        .nav__trigger-input:focus+label::before {
            opacity: 1;
        }

        .nav__trigger-input:checked+label {
            height: 10px;
            color: rgb(0, 0, 0);
        }

        .nav__trigger-input:checked+label span {
            transform: rotate(45deg);
        }

        .nav__trigger-input:checked+label span::before,
        .nav__trigger-input:checked+label span::after {
            top: calc(50% - 1px);
            transition: transform 0.4s 0.4s cubic-bezier(0.75, 0, 0.25, 1), top 0.4s cubic-bezier(0.75, 0, 0.25, 1), background 0.2s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__trigger-input:checked+label span::after {
            transform: rotate(90deg);
        }

        .nav__trigger-input:checked~ul {
            z-index: 9;
            transform: none;
            transition: 0.5s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__list {
            position: fixed;
            overflow-y: scroll;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            z-index: 3100;
            background: rgb(255, 247, 179);
            font-size: 4rem;
            padding: 40px;
            transform: translateX(100%);
            /*translate(100vw) rotate (45deg); */
            transition: 0.3s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__item {
            list-style: none;
        }

        .nav__item+.nav__item {
            margin-top: 20px;
        }

        .nav__submenu-trigger-input:checked+label::after {
            transform: translateY(10px);
        }

        .nav__submenu-trigger-input:checked~ul {
            display: block;
        }

        .nav__submenu-trigger-input:focus+label::after {
            transform: translateY(5px);
        }

        .nav__submenu-trigger-finger::after {
            content: "";
            display: inline-block;
            border: 10px solid transparent;
            border-top-color: rgb(0, 0, 0);
            transition: 0.4s cubic-bezier(0.75, 0, 0.25, 1);
        }

        .nav__link {
            text-decoration: none;
            color: inherit;
        }

        .nav__list-child {
            display: none;
            font-size: 2rem;
            margin-top: 10px;
            z-index: 3100;
            padding-left: 2rem;
        }

        body,
        html {
            height: 100%;
            margin: 0;
            font-family: 'Exo 2', cursive;
            padding-bottom: 100px;
            /* Eller höjden på din footer */
        }

        * {
            box-sizing: border-box;
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('/tallriken/images/bluebackground.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            z-index: -1;
        }


        .blur-background .background-container {
            filter: blur(5px);
        }

        .logo-image {
            width: 200px;
            /* eller en procentandel, beroende på dina behov */
            height: auto;
            /* Bibehåller bildens proportioner */
        }


        .search-container {
            /* position: fixed; */
            top: unset;
            left: unset;
            transform: unset;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1000;
            width: 40%;
            /* Ökar bredden av sökfältet */
            /* transition: opacity 0.5s ease; */
            /* Lägg till denna rad */
        }

        .slider-button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            /* Justera avståndet mellan sliders och sökfält */
        }

        .input-button-container {
            display: flex;
            width: 100%;
        }

        .input-button-container input[type='text'] {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: white;
            color: black;
            outline: none;
            border-radius: 25px 0 0 25px;
            /* Avrundade hörn till vänster (både upp och ner) */
        }

        .input-button-container button {
            padding: 10px 20px;
            border: 1px solid #ddd;
            background-color: white;
            color: black;
            outline: none;
            cursor: pointer;
            border-radius: 0;
            /* Inga avrundade hörn */
            border-left: none;
            /* Ta bort vänster gräns för att smälta ihop med föregående element */
        }

        .input-button-container button:last-child {
            border-radius: 0 25px 25px 0;
            /* Avrundade hörn till höger (både upp och ner) */
        }

        #data-container.initial {
            margin-top: 400px;
            /* Anpassa detta värde så att det passar layouten av din sökcontainer */
        }

        #data-container.search-active {
            margin-top: 0;
            /* Anpassa detta värde som behövs */
        }



        #data-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 5%;
            padding-bottom: 20px;
            overflow: auto;
            z-index: 1500;
            /* högre än sökfältets z-index */
        }

        .matratt {
            flex: 0 0 calc(33.33% - 20px);
            max-width: calc(33.33% - 20px);
            margin: 10px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-sizing: border-box;
            align-self: flex-start;
            position: relative;
        }

        .matratt iframe {
            width: 100%;
            height: 600px;
            overflow-y: auto;
            display: block;
            border: none;
            transform: scale(0.95);
            transform-origin: top center;
        }

        .matratt-title {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px;
            margin: 5px 0;
            border-radius: 10px;
        }

        .matratt-ingredienser div {
            position: absolute;
            left: 0;
            animation: ticker 20s linear infinite;
        }

        .ingrediens-knapp {
            background-color: #f2f2f2;
            border: none;
            padding: 5px 10px;
            margin-top: 5px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .ingrediens-lista {
            display: none;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            position: absolute;
            top: 40px;
            left: 0;
            right: 0;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
        }

        @keyframes ticker {
            0% {
                left: 100%;
            }

            100% {
                left: -100%;
            }
        }

        .instagram-media iframe {
            width: 100%;
            min-height: 500px;
            display: block;
        }

        .matratt h2,
        .matratt p,
        .matratt a {
            margin: 5px 0;
        }






        /* Lägg till den nya CSS-koden för footer-banner här */
        .footer-banner {
            background-color: #000;
            color: white;
            padding: 10px 20px;
            position: fixed;
            bottom: 0;
            width: 100%;
            display: flex;
            align-items: center;
            /* Ta bort justify-content: space-between om du inte vill att innehållet ska fördelas på varje sida */
        }

        .footer-banner a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
        }

        .footer-banner a:hover {
            text-decoration: underline;
        }

        .footer-links {
            display: flex;
            margin-left: auto;
            /* Lägger till detta för att skjuta elementet till högerkanten */

        }

        /* Stil för copyright-texten */
        .footer-banner p {
            margin: 0;
            color: white;
            /* Om du tar bort justify-content från .footer-banner, kan du också behöva ta bort flex-grow */
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            width: 100%;
            /* Matcha bredden med sökfältet */
            padding: 5px;
            border-radius: 0 0 25px 25px;
            /* Behåll rundade hörn endast på botten om så önskas */
            margin-top: 0;
            /* Ta bort mellanrummet mellan fält och taggar */
            /* Ta bort border-egenskapen för att eliminera den vita konturen */
        }

        .tag {
            position: relative;
            background-color: #ddd;
            padding: 5px 10px;
            margin-right: 5px;
            border-radius: 3px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;

        }

        .tag-close {
            margin-left: 5px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1rem;
        }

        .hidden-search {
            visibility: hidden;
            opacity: 0;
            transform: translate(-50%, -50%);
            transition: visibility 0s 0.3s, opacity 0.3s ease;
        }



        .blur-background {
            filter: blur(5px);
        }

        .logo-link {
            position: fixed;
            top: 10px;
            /* Justera avståndet från toppen */
            left: 10px;
            /* Justera avståndet från vänsterkanten */
            z-index: 3000;
            /* Se till att loggan alltid är överst */
        }

        .logo-link img {
            height: 50px;
            /* Justera storleken på loggan */
            width: auto;
            /* Behåller bildens aspektförhållande */
        }

        .matratt-title,
        .ingrediens-knapp,
        .ingrediens-lista {
            color: white;
            /* Vit text */
            background-color: rgba(0, 0, 0, 0.8);
            /* Svart bakgrund */
        }

        /* Stilen för omkopplaren */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            /* Bredden på omkopplaren */
            height: 34px;
            /* Höjden på omkopplaren */
        }

        /* "Slider" */
        .switch .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            /* Bakgrundsfärg för slider när den är av */
            -webkit-transition: .4s;
            transition: .4s;
        }

        .switch .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            /* Höjden på den vita delen som glider */
            width: 26px;
            /* Bredden på den vita delen som glider */
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked+.slider {
            background-color: rgb(255, 247, 179);
            /* Färg när omkopplaren är på */
        }

        input:focus+.slider {
            box-shadow: 0 0 1px rgb(255, 247, 179);
        }

        input:checked+.slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rundade kanter på omkopplaren */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }

        .switch.large {
            position: relative;
            display: inline-block;
            width: 150px;
            /* Bredden på hela omkopplaren */
            height: 34px;
            /* Höjden på omkopplaren */
            margin: 0 10px;
            /* Mellanrum runt omkopplaren */
        }

        .switch.large .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            /* Bakgrundsfärg när slidern är av */
            transition: .4s;
            border-radius: 34px;
            /* Rundade hörn på slidern */
        }

        /* Stil för "knappen" på slidern */
        .switch.large .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            /* Höjden på knappen */
            width: 26px;
            /* Bredden på knappen */
            left: 4px;
            /* Position från vänster */
            bottom: 4px;
            /* Centrera knappen vertikalt */
            background-color: white;
            /* Färg på knappen */
            transition: .4s;
            border-radius: 50%;
            /* Gör den cirkulär */
        }

        input:checked+.switch.large .slider {
            background-color: rgb(225, 213, 178);
            /* Färg när switch är på */
        }

        input:checked+.switch.large .slider:before {
            -webkit-transform: translateX(calc(150px - 26px - 4px));
            /* Beräkna rätt flytt för knappen */
            -ms-transform: translateX(calc(150px - 26px - 4px));
            /* Beräkna rätt flytt för knappen */
            transform: translateX(calc(150px - 26px - 4px));
            /* Beräkna rätt flytt för knappen */
        }


        /* Stiljusteringar för textetiketterna för slidern */
        .search-mode-label {
            display: block;
            font-family: 'Exo 2', cursive;
            color: white;
            background-color: rgba(0, 0, 0, 0.7);
            text-align: center;
            padding: 5px;
            border-radius: 5px;
            margin: 0 5px;
            /* Utrymme runt etiketterna */
            /* Ytterligare stilinställningar efter behov */
        }

        /* Säkerställ att texten är centrerad vertikalt */
        .search-mode-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
        }


        input:checked+.slider.large {
            background-color: #0075fe;
            /* Grön färg när slidern är till höger */
        }

        input:not(:checked)+.slider.large {
            background-color: #0075fe;
            /* Röd färg när slidern är till vänster */
        }

        .veg-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-left: 10px;
            /* Justera detta värde efter behov */
        }

        .veg-label {
            background-color: rgba(0, 0, 0, 0.7);
            /* Svart med lite transparens */
            color: white;
            padding: 5px;
            margin-bottom: 5px;
            /* Uttrymme mellan etiketten och slidern */
            text-align: center;
            border-radius: 5px;
        }

        .lang-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-left: 10px;
        }

        .lang-label {
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            margin-bottom: 5px;
            text-align: center;
            border-radius: 5px;
        }

        #pagination-controls button {
            background-color: white;
            /* Vit bakgrund */
            color: black;
            /* Svart text */
            border: 1px solid #ddd;
            /* Lätt grå kantlinje */
            padding: 10px 15px;
            /* Padding för att göra knappen större */
            margin: 5px;
            /* Avstånd mellan knapparna */
            border-radius: 5px;
            /* Lätt rundade hörn */
            cursor: pointer;
            /* Ändra muspekaren till en hand när den svävar över knappen */
            font-size: 1em;
            /* Storlek på texten */
            transition: background-color 0.3s;
            /* Smidig övergång för bakgrundsfärg */
            font-family: 'Exo 2', cursive;
            /* Din huvudfont */
        }

        #pagination-controls button:hover {
            background-color: rgb(255, 247, 179);
            /* Ljusgul bakgrund när muspekaren svävar över */
        }

        /* Uppdateringar för #pagination-controls */
        #pagination-controls {
            position: fixed;
            /* Istället för absolute */
            bottom: 100px;
            /* Höjden på din footer */
            left: 0;
            right: 0;
            z-index: 2;
            text-align: center;
            margin-bottom: 20px;
            /* Detta kan behöva justeras beroende på exakt placering */
            padding: 10px 0;
        }

        #pagination-controls.hidden {
            display: none;
            /* Dölj pagineringskontrollerna */
        }

        @media (max-width: 480px) {
            .logo-link img {
                height: 80px;
                /* Justera storleken på logotypen om det behövs */
            }

            .search-container {
                /* Ta bort 'position: fixed' och 'transform' egenskaper */
                top: 240px;
                left: unset;
                transform: unset;
                display: flex;
                flex-direction: column;
                align-items: center;
                z-index: 1000;
                width: 40%;
                /* Resten av din befintliga stil */
            }


            #data-container.initial {
                margin-top: 180px;
                /* Minska detta värde för att minska utrymmet mellan sökfält och resultat */
            }

            #data-container {
                margin-top: 180px;
                /* Öka detta värde för att skapa utrymme mellan sökfältet och sökresultaten */
            }


            .input-button-container input[type='text'],
            .input-button-container button {
                padding: 10px;
                /* Justera padding för att passa bättre på mindre skärmar */
                font-size: 16px;
                /* Justera textstorleken om det behövs */
            }

            .input-button-container button {
                padding-right: 10px;
                /* Minska padding till höger */
                padding-left: 10px;
                /* Minska padding till vänster */
            }

            .matratt {
                flex-basis: 100%;
                max-width: 100%;
                margin: 10px 0;
            }

            .search-container * {
                pointer-events: auto;
            }

            body,
            html {
                overflow-x: hidden;
                /* Fortsätt förhindra horisontell scrollning */
            }

            /* Behåll andra befintliga stilar som du inte vill ändra */


        }



        .current-page {
            background-color: rgb(255, 247, 179) !important;
            color: black !important;
        }



        /* Stil för placeholder-texten */
        #searchInput::placeholder {
            font-family: 'Exo 2', cursive;
            /* Eller det typsnitt du använder på resten av din sida */
            font-size: 18px;
            /* Eller den storlek du vill ha */
            color: #999;
            /* Färgen på din placeholder-text, ändra efter önskemål */
        }

        .add-button {
            background: none;
            border: none;
            cursor: pointer;
        }

        .add-button img {
            width: 25px;
            /* or any size that fits your design */
            height: auto;
        }
    </style>
</head>

<body>
    <nav class="nav">
        <input class="nav__trigger-input" type="checkbox" id="trigger" aria-label="open the navigation" />
        <label class="nav__trigger-finger" for="trigger">
            <span></span>
        </label>
        <ul class="nav__list">
            <li class="nav__item">
                <a href="#hoi" class="nav__link">
                    <span class="nav__text">
                        Startsida
                    </span>
                </a>
            </li>
            <li class="nav__item">
                <a href="#hoi" class="nav__link">
                    <span class="nav__text">
                        Om
                    </span>
                </a>
                <input class="nav__submenu-trigger-input" type="checkbox" id="submenu-trigger" />
                <label class="nav__submenu-trigger-finger" for="submenu-trigger"></label>
                <ul class="nav__list-child">
                    <li class="nav__item">
                        <a href="#hoi" class="nav__link">
                            <span class="nav__text">
                                Om oss
                            </span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#hoi" class="nav__link">
                            <span class="nav__text">
                                Tipsa Oss
                            </span>
                        </a>
                    </li>
                </ul>
            </li>
            <li class="nav__item">
                <a href="#hoi" class="nav__link">
                    <span class="nav__text">
                        Blogg
                    </span>
                </a>
                <input class="nav__submenu-trigger-input" type="checkbox" id="submenu-trigger" />
                <label class="nav__submenu-trigger-finger" for="submenu-trigger"></label>
                <ul class="nav__list-child">
                    <li class="nav__item">
                        <a href="#hoi" class="nav__link">
                            <span class="nav__text">
                                Knivar & Kastruller
                            </span>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#hoi" class="nav__link">
                            <span class="nav__text">
                                Inredning
                            </span>
                        </a>
                    </li>
                </ul>
            </li>
            <!-- <li class="nav__item">
                <a href="#hoi" class="nav__link">
                    <span class="nav__text">
                        Blogg
                    </span>
                </a>
            </li> -->
            <li class="nav__item">
                <a href="#hoi" class="nav__link">
                    <span class="nav__text">
                        Kontakt
                    </span>
                </a>
            </li>
        </ul>
    </nav>

    <a href="index.html" class="logo-link">
        <img src="images/visplogo/Logo Files/For Web/svg/White logo - no background.svg" alt="Logga" />
    </a>

    <div class="background-container"></div>

    <!-- Logotyp Container -->
    <div class="logo-container" style="text-align: center; margin-top: 20px;">
        <img src="images/visplogo/Logo Files/For Web/svg/Black logo - no background.svg" alt="Logotyp" class="logo-image">

    </div>

    <div class="search-container">
        <!-- Ny slider här 
        <div class="search-mode-container">
            <div class="search-mode-label">←Sök på ingredienser</div>
            <label class="switch large">
                <input type="checkbox" id="searchModeSwitch" onchange="toggleSearchMode()">
                <span class="slider round large"></span>
            </label>
            <div class="search-mode-label">Sök på maträtt→</div>
        </div> -->
        <!-- Slider-knappar ovanför sökfältet -->
        <div class="slider-button-container">
            <div class="veg-container">
                <div class="veg-label">Bara Veg</div>
                <label class="switch">
                    <input type="checkbox" id="vegSwitch" onchange="toggleVegFilter()">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="lang-container">
                <div class="lang-label">Bara recept på svenska</div>
                <label class="switch">
                    <input type="checkbox" id="langSwitch" onchange="toggleLangFilter()">
                    <span class="slider round"></span>
                </label>
            </div>
        </div>

        <!-- Sökfält och knappar -->
        <div class="input-button-container">
            <input type="text" id="searchInput" placeholder="Skriv ingrediens o tryck Enter...">
            <button onclick="addTagFromButton()" class="add-button">
                <img src="images/knifeforksign.jpg
                " alt="Add" />
            </button> <!-- Ny knapp för att lägga till taggar -->
            <!-- <button onclick="performSearch()">Sök</button> -->
        </div>

        <!-- Taggarna här -->
        <div class="tag-container"></div>
    </div>


    <div id="data-container" class="initial"></div>

    <div id="pagination-controls"></div>

    <div class="footer-banner">
        <!-- Footer content -->
        <!-- Innehåll för din banner, t.ex. Om Oss och Tipsa Oss länkar -->
    </div>

    <script>

        const apiKey = 'AIzaSyBFecFz9KFsPnw6bjAKv0N0CSbs3Iszlag';
        const spreadsheetId = '1RN9SQRzletJnH8BAgJEQCI0BtbpsHQU6Pv2L4FDGXEM';
        const dataRange = 'Blad1!A2:J';
        const synonymRange = 'Ingredienser!A2:B';
        const dataUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${dataRange}?key=${apiKey}`;
        const synonymUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${synonymRange}?key=${apiKey}`;

        let allData = [];
        let currentFilteredData = []; // Ny global variabel för att hålla den aktuellt filtrerade datan
        let selectedTags = [];
        let isVegFilterActive = false;
        let isLangFilterActive = false;
        let ingredientSynonyms = {};
        let searchForDishes = false; // eller true, beroende på din standardinställning
        let primaryIngredients = {};
        let nonPrimarySynonyms = {};
        let groupedIngredients = {};
        // Lägg till dessa nya variabler för sidindelning
        let currentPage = 1;
        const resultsPerPage = 15;
        let totalPages = 0;




        async function loadData() {
            try {
                // Load the main data as before
                const dataResponse = await fetch(dataUrl);
                const data = await dataResponse.json();
                allData = data.values; // Assume this includes all your recipe data
                console.log('Main data loaded:', allData);

                // Load synonym data
                const synonymResponse = await fetch(synonymUrl);
                const synonymData = await synonymResponse.json();
                primaryIngredients = {}; // Reset the mapping object for primary ingredients
                nonPrimarySynonyms = {}; // Reset the mapping object for non-primary synonyms
                synonymData.values.forEach(row => {
                    const ingredient = row[0]?.toLowerCase().trim(); // Ingredient
                    const synonyms = row[1]?.toLowerCase().split(',').map(s => s.trim()); // Synonyms
                    if (row[2]?.toLowerCase() === 'ja') {
                        primaryIngredients[ingredient] = synonyms;
                    } else {
                        nonPrimarySynonyms[ingredient] = synonyms;
                    }
                });
                console.log('Primary ingredients loaded:', primaryIngredients);
                console.log('Non-primary synonyms loaded:', nonPrimarySynonyms);

                // Load data for grouped ingredients
                const groupedIngResponse = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/Ingredienser!A2:C?key=${apiKey}`);
                const groupedIngData = await groupedIngResponse.json();
                groupedIngredients = {};
                groupedIngData.values.forEach(row => {
                    const searchTerm = row[1]?.toLowerCase().trim(); // Search term from column B
                    const ingredientsGroup = row[2]?.toLowerCase().split(',').map(ing => ing.trim()); // Grouped ingredients from column C
                    if (ingredientsGroup && ingredientsGroup.length > 0) {
                        groupedIngredients[searchTerm] = ingredientsGroup;
                    }
                });
                console.log('Grouped ingredients loaded:', groupedIngredients);
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }



        async function loadSynonyms() {
            try {
                const synonymResponse = await fetch(synonymUrl);
                const synonymData = await synonymResponse.json();

                // Logga ut hela synonymData-objektet för att se vad som faktiskt laddas
                console.log('Synonym data:', synonymData);

                // Kontrollera om synonymData.values är definierat och är en array
                if (Array.isArray(synonymData.values)) {
                    ingredientSynonyms = {}; // Återställ mappningsobjektet för synonymer

                    synonymData.values.forEach(row => {
                        // Kontrollera att varje rad har två element
                        if (row.length >= 2) {
                            const ingredients = row[0]?.toLowerCase().trim(); // Huvudingredienserna
                            const searchTerms = row[1]?.toLowerCase().split(',').map(s => s.trim()); // Sökorden

                            // Skapa en omvänd lookup där varje sökterm pekar på huvudingrediensen
                            searchTerms.forEach(term => {
                                ingredientSynonyms[term] = ingredients;
                            });
                        } else {
                            console.error('Invalid row format:', row);
                        }
                    });

                    console.log('Synonyms and search terms loaded:', ingredientSynonyms);
                } else {
                    console.error('synonymData.values is not an array:', synonymData.values);
                }
            } catch (error) {
                console.error('Error loading synonyms:', error);
            }
        }


        async function performSearch() {
            currentPage = 1; // Återställer till första sidan vid varje ny sökning
            let searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            console.log('Search term:', searchTerm);
            let filteredData = allData; // Använd allData som utgångspunkt

            if (searchForDishes) {
                // Search based on dish name
                filteredData = allData.filter(row => row[0].toLowerCase().includes(searchTerm));

                // Filter for Vegetarian and Swedish recipes if activated
                if (isVegFilterActive) {
                    filteredData = filteredData.filter(row => row[6]?.toLowerCase() === 'ja');
                }
                if (isLangFilterActive) {
                    filteredData = filteredData.filter(row => row[7]?.toLowerCase() === 'ja');
                }

                console.log('Filtered data:', filteredData);
            } else {
                // For each selected tag, find matching individual ingredients or grouped ingredients
                let searchIngredients = selectedTags.flatMap(tag => {
                    if (groupedIngredients[tag]) {
                        return groupedIngredients[tag];
                    } else if (ingredientSynonyms[tag]) {
                        let ingredientsArray = ingredientSynonyms[tag].split(', ').map(ing => ing.trim());
                        return ingredientsArray;
                    } else {
                        return [tag];
                    }
                });

                console.log('Ingredients to search for:', searchIngredients);

                filteredData = allData.filter(row => {
                    const ingredients = row[1]?.toLowerCase().split(', ').map(ing => ing.trim());
                    return searchIngredients.every(ingredient => ingredients.includes(ingredient));
                });

                if (isVegFilterActive) {
                    filteredData = filteredData.filter(row => row[6]?.toLowerCase() === 'ja');
                }
                if (isLangFilterActive) {
                    filteredData = filteredData.filter(row => row[7]?.toLowerCase() === 'ja');
                }
            }
            // Efter filtrering, spara den filtrerade listan i currentFilteredData
            currentFilteredData = filteredData;

            // Använd currentFilteredData för att visa den första sidan av sökresultaten
            totalPages = Math.ceil(currentFilteredData.length / resultsPerPage);
            displayData(currentFilteredData, currentPage);
        }


        // Fortsätt med resten av din JavaScript-kod här...




        function addTagFromButton() {
            const inputField = document.getElementById('searchInput');
            const input = inputField.value.trim().toLowerCase();

            if (searchForDishes) {
                console.log("Lägg till knappen är inaktiv när sökning på maträtter är aktiverad");
                return;
            }

            if (input && !selectedTags.includes(input)) {
                selectedTags.push(input);
                updateTagContainer();
            }

            inputField.value = ''; // Rensa inputfältet
        }

        function toggleVegFilter() {
            let vegSwitch = document.getElementById('vegSwitch');
            isVegFilterActive = vegSwitch.checked;
        }

        function toggleLangFilter() {
            let langSwitch = document.getElementById('langSwitch');
            isLangFilterActive = langSwitch.checked;
        }

        function toggleSearchMode() {
            const searchModeSwitch = document.getElementById('searchModeSwitch');
            searchForDishes = searchModeSwitch.checked;
            if (searchForDishes) {
                console.log("Sökning på maträtter aktiverad");
            } else {
                console.log("Sökning på ingredienser aktiverad");
            }
        }

        document.getElementById('searchInput').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const input = this.value.trim().toLowerCase();

                // Om sökning på maträtter är aktiverad, utför sökningen direkt.
                if (searchForDishes) {
                    performSearch();
                    return;
                }

                // Lägg till tagg om möjligt och utför sökning.
                if (input && !selectedTags.includes(input)) {
                    selectedTags.push(input);
                    updateTagContainer();
                }

                performSearch(); // Utför sökningen direkt efter att en tagg har lagts till eller söktermen angivits.
                this.value = ''; // Rensa inputfältet
            }
        });







        function updateTagContainer() {
            const container = document.querySelector('.tag-container');
            container.innerHTML = selectedTags.map(tag => `
        <div class="tag">
            ${tag}
            <button class="tag-close" onclick="removeTag('${tag}')">×</button>
        </div>
    `).join('');
        }

        function displayData(data, page) {
            var startIndex = (page - 1) * resultsPerPage;
            var endIndex = startIndex + resultsPerPage;
            var pageData = data.slice(startIndex, endIndex);
            var dataContainer = document.getElementById('data-container');
            dataContainer.classList.add('initial');

            var htmlContent = '';
            pageData.forEach((row, index) => {
                htmlContent += `<div class="matratt">`;
                htmlContent += `<div class="matratt-title"><h2>${row[0]}</h2></div>`; // Maträttens namn

                /* // Knapp för att visa ingredienser
                htmlContent += `<button class="ingrediens-knapp" onclick="toggleIngredienser(this)">Visa Ingredienser</button>`;

                // Rullista för ingredienser med mouseleave-händelse
                htmlContent += `<div class="ingrediens-lista" onmouseleave="hideIngredienser(this)">${row[1].split(', ').join('<br>')}</div>`; */

                htmlContent += row[5]; // Instagram-inlägg
                htmlContent += '</div>';
            });

            document.getElementById('data-container').innerHTML = htmlContent;

            // Processa Instagram-inlägg
            if (window.instgrm) {
                window.instgrm.Embeds.process();
            }

            // Visa pagineringskontroller
            displayPaginationControls();
        }

        function displayPaginationControls() {
            var paginationHtml = '';
            const pageWindow = 2; // Antal sidor att visa på varje sida om den aktuella sidan
            let startPage = Math.max(currentPage - pageWindow, 1);
            let endPage = Math.min(currentPage + pageWindow, totalPages);

            // Lägg till länk till första sidan och ellips om det behövs
            if (startPage > 1) {
                paginationHtml += `<button onclick="goToPage(1)">1</button>`;
                if (startPage > 2) paginationHtml += `<span>...</span>`; // Ellips för att visa gap
            }

            // Visa sidnummer nära den aktuella sidan
            for (let i = startPage; i <= endPage; i++) {
                paginationHtml += `<button class="${i === currentPage ? 'current-page' : ''}" onclick="goToPage(${i})">${i}</button>`;
            }

            // Lägg till ellips och länk till sista sidan om det behövs
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) paginationHtml += `<span>...</span>`; // Ellips för att visa gap
                paginationHtml += `<button onclick="goToPage(${totalPages})">${totalPages}</button>`;
            }

            document.getElementById('pagination-controls').innerHTML = paginationHtml;
        }

        function goToPage(pageNumber) {
            currentPage = pageNumber;
            displayData(currentFilteredData, currentPage); // Använd currentFilteredData här
        }


        function toggleIngredienser(button) {
            var ingrediensLista = button.nextElementSibling;
            ingrediensLista.style.display = ingrediensLista.style.display === 'block' ? 'none' : 'block';
        }

        function hideIngredienser(ingrediensLista) {
            ingrediensLista.style.display = 'none';
        }



        window.onload = async function () {
            await loadData();
            await loadSynonyms();
            // Eventuella ytterligare initialiseringar eller funktioner som ska köras efter att data och synonymer har laddats
        };

        window.addEventListener('DOMContentLoaded', function () {
            const searchContainer = document.querySelector('.search-container');
            const tagContainer = document.querySelector('.tag-container');
            let lastScrollTop = 0;

            window.addEventListener('scroll', function () {
                var currentScroll = window.pageYOffset || document.documentElement.scrollTop;

                if (currentScroll > lastScrollTop) {
                    // Användaren scrollar neråt
                    console.log('Scrolling down');
                    searchContainer.style.opacity = '0';
                    searchContainer.style.visibility = 'hidden';
                    tagContainer.style.opacity = '0';
                    tagContainer.style.visibility = 'hidden';
                } else {
                    // Användaren scrollar uppåt
                    console.log('Scrolling up');
                    searchContainer.style.opacity = '1';
                    searchContainer.style.visibility = 'visible';
                    tagContainer.style.opacity = '1';
                    tagContainer.style.visibility = 'visible';
                }
                lastScrollTop = currentScroll <= 0 ? 0 : currentScroll;
            }, false);
        });








        function removeTag(tagToRemove) {
            selectedTags = selectedTags.filter(tag => tag !== tagToRemove);
            updateTagContainer(); // Uppdaterar taggkontainern
            performSearch(); // Utför en ny sökning med uppdaterade taggar
        }



    </script>

    <script async src="//www.instagram.com/embed.js"></script>


    <div class="footer-banner">
        <p class="copyright">&copy; 2023. All rights reserved.</p>
        <div class="footer-links">
            <a href="omoss.html">Om</a>
            <a href="tipsaoss.html">Tipsa</a>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const triggerInput = document.querySelector('.nav__trigger-input');
            const searchContainer = document.querySelector('.search-container');
            let lastScrollTop = 0;

            triggerInput.addEventListener('change', () => {
                if (triggerInput.checked) {
                    searchContainer.style.zIndex = '-1';
                } else {
                    searchContainer.style.zIndex = '1000';
                }
            });

        });


    </script>
</body>

</html>